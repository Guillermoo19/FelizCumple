<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üéâ Feliz Cumplea√±os Maylin üéâ</title>
    <link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéâ</text></svg>">
    <!-- Importamos las fuentes de Google para un estilo visual atractivo -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Dancing+Script:wght@700&family=Montserrat:wght@400&display=swap" rel="stylesheet">

    <style>
        /* Paleta de colores centralizada para f√°cil edici√≥n */
        :root {
            --bg-gradient-top: #1d0207; /* Color superior del degradado de fondo */
            --bg-gradient-bottom: #000000; /* Color inferior del degradado de fondo */
            
            --primary-color: #FF69B4; /* Color principal para elementos destacados (Rosa Vibrante/Hot Pink) */
            --primary-glow: #FFC0CB; /* Color para el efecto de brillo principal (Rosa Claro) */
            --text-color-light: #ffffff; /* Color de texto claro */
            --text-shadow-dark: rgba(0, 0, 0, 0.7); /* Sombra de texto oscura */
            
            --modal-bg: #0f0c29; /* Color de fondo del modal */
            --modal-shadow: rgba(0, 0, 0, 0.8); /* Sombra del modal */
            --modal-gradient-1: #0f0c29; /* Colores para el degradado del modal */
            --modal-gradient-2: #C71585; /* Medium Violet Red */
            --modal-gradient-3: #FF1493; /* Deep Pink */
            --modal-gradient-4: #FF69B4; /* Hot Pink */
            --modal-gradient-5: #FFB6C1; /* Light Pink */

            --title-glow-1: rgba(255, 105, 180, 0.8); /* Colores para el brillo del t√≠tulo (Hot Pink rgba) */
            --title-glow-2: rgba(255, 192, 203, 0.6); /* Pink rgba */
            
            --image-border: rgba(255, 255, 255, 0.8); /* Borde de la imagen en el modal */
            --image-shadow: rgba(0, 0, 0, 0.5); /* Sombra de la imagen */
        }

        /* --- ESTILOS GENERALES Y DE FONDO --- */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden; /* Evita barras de desplazamiento */
            font-family: 'Montserrat', sans-serif; /* Fuente principal */
            background: linear-gradient(to bottom, var(--bg-gradient-top), var(--bg-gradient-bottom)); /* Degradado de fondo */
        }
        
        /* --- PANTALLA DE CARGA --- */
        #loader-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: var(--bg-gradient-bottom); /* Fondo de la pantalla de carga */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 9999; /* Asegura que est√© por encima de todo */
            transition: opacity 0.8s ease-out, visibility 0.8s ease-out; /* Transici√≥n para ocultar */
            opacity: 1;
            visibility: visible;
        }

        #loader-container.hidden {
            opacity: 0;
            visibility: hidden;
            pointer-events: none; /* Permite clics a trav√©s una vez oculto */
        }

        .loader-content {
            text-align: center;
        }
        
        .loader-heart {
            width: 80px;
            height: 80px;
            background-color: var(--primary-color); /* Coraz√≥n de carga con el nuevo color */
            position: relative;
            transform: rotate(-45deg); /* Forma de coraz√≥n con rotaci√≥n */
            margin: 0 auto 50px auto;
            animation: heart-pulse 1.5s ease-in-out infinite; /* Animaci√≥n de pulso */
        }

        .loader-heart::before,
        .loader-heart::after {
            content: '';
            width: 80px;
            height: 80px;
            background-color: var(--primary-color); /* Partes del coraz√≥n de carga con el nuevo color */
            border-radius: 50%; /* Crea las formas redondeadas del coraz√≥n */
            position: absolute;
        }

        .loader-heart::before { top: -40px; left: 0; }
        .loader-heart::after { top: 0; left: 40px; }

        @keyframes heart-pulse {
            0% { transform: rotate(-45deg) scale(1); }
            50% { transform: rotate(-45deg) scale(1.1); }
            100% { transform: rotate(-45deg) scale(1); }
        }

        .progress-bar-container {
            width: 250px;
            height: 8px;
            border: 1px solid var(--primary-color); /* Borde de la barra de progreso con el nuevo color */
            border-radius: 5px;
            overflow: hidden;
            margin-bottom: 15px;
        }

        #progress-bar {
            width: 0%;
            height: 100%;
            background: var(--primary-color); /* Fondo de la barra de progreso con el nuevo color */
            border-radius: 5px;
            transition: width 0.4s ease-out;
        }
        
        #progress-text {
            color: var(--text-color-light);
            font-family: 'Montserrat', sans-serif;
        }

        canvas#bg {
            position: fixed;
            top: 0;
            left: 0;
            z-index: 1; /* Detr√°s de los elementos de UI */
        }

        /* --- TEXTO "CLICK ME" --- */
        .click-me-container {
            position: fixed;
            bottom: 10%;
            left: 50%;
            transform: translateX(-50%);
            z-index: 2;
            text-align: center;
            opacity: 0; /* Inicialmente oculto */
            transition: opacity 1s ease-in;
        }

        #clickMeText {
            color: var(--primary-color); /* Color del texto "Presiona aqu√≠, Sister" con el nuevo color */
            font-family: 'Dancing Script', cursive;
            font-size: 3rem;
            cursor: pointer;
            text-shadow: 0 0 10px var(--primary-color), 0 0 20px var(--primary-color), 0 0 30px var(--primary-glow); /* Efecto de brillo con los nuevos colores */
            transition: color 0.3s, text-shadow 0.3s;
            animation: pulse 2s infinite; /* Animaci√≥n de pulso para el texto */
        }

        #clickMeText:hover {
            color: var(--text-color-light);
            text-shadow: 0 0 15px var(--text-color-light), 0 0 25px var(--text-color-light), 0 0 40px var(--primary-color);
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.05); }
            100% { transform: scale(1); }
        }

        /* --- VENTANA MODAL PRINCIPAL --- */
        .modal-container {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.7); /* Fondo semi-transparente */
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 10; /* Por encima de todo lo dem√°s */
            opacity: 0; /* Inicialmente oculto */
            pointer-events: none; /* No interactuable hasta que est√© activo */
            transition: opacity 0.5s ease;
        }

        .modal-container.active {
            opacity: 1;
            pointer-events: auto; /* Interactuable cuando est√° activo */
        }
        
        .modal-content {
            background-color: var(--modal-bg);
            padding: 40px 50px;
            border-radius: 30px;
            box-shadow: 0 10px 40px var(--modal-shadow);
            max-width: 900px;
            width: 90%;
            position: relative;
            overflow: hidden;
            transform: scale(0.9); /* Efecto de escala al aparecer */
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            will-change: transform;
        }
        
        .modal-content::before {
            content: '';
            position: absolute;
            z-index: -1; /* Detr√°s del contenido */
            top: -100%; left: -100%;
            width: 300%; height: 300%;
            background: linear-gradient(-45deg, var(--modal-gradient-1), var(--modal-gradient-2), var(--modal-gradient-3), var(--modal-gradient-4), var(--modal-gradient-5)); /* Degradado de fondo en el modal */
        }

        .modal-container.active .modal-content {
            transform: scale(1); /* Escala normal al activarse */
        }

        .close-button {
            position: absolute;
            top: 15px; right: 25px;
            font-size: 2.5rem; color: var(--text-color-light); cursor: pointer;
            transition: color 0.3s, transform 0.3s; text-shadow: 0 0 10px var(--primary-color);
            z-index: 20; /* Por encima del contenido del modal */
        }
        .close-button:hover {
            color: var(--primary-color); transform: rotate(90deg);
            text-shadow: 0 0 15px var(--text-color-light);
        }
        
        .modal-content h1 {
            font-family: 'Dancing Script', cursive; color: var(--text-color-light);
            text-align: center; font-size: 3.2rem;
            margin-bottom: 25px;
            text-shadow: 0 0 15px var(--title-glow-1), 0 0 30px var(--title-glow-2);
        }
        
        .modal-body { 
            display: flex; 
            align-items: center; 
            gap: 40px; 
            justify-content: center; /* Centra el contenido horizontalmente */
        }
        .text-content { 
            text-align: center; /* Centra el texto dentro de su contenedor */
        }
        
        .text-content p {
            font-family: 'Montserrat', sans-serif; font-weight: 400; font-size: 1.15rem; line-height: 1.7;
            color: var(--text-color-light); margin-bottom: 20px;
            text-shadow: 0 0 8px var(--text-shadow-dark);
        }
        .text-content .signature {
            font-family: 'Dancing Script', cursive; font-size: 1.8rem;
            color: var(--text-color-light);
            text-shadow: 0 0 15px var(--text-shadow-dark);
        }

        /* La secci√≥n .image-content ha sido eliminada de aqu√≠ */

        /* --- Media Queries y Ajustes Responsivos --- */
        @media (max-width: 850px) {
            .modal-content h1 { font-size: 2.5rem; }
            .modal-body { flex-direction: column; gap: 25px; }
        }
        
        @media (max-width: 480px) {
            .modal-content { padding: 35px 20px 25px 20px; width: 95%; }
            .modal-content h1 { font-size: 2rem; }
            .text-content p { font-size: 1rem; }

            .close-button {
                top: 10px;
                right: 15px;
            }
        }

        /* --- ESTILOS PARA EL MODAL INTERMEDIO (LA CARTA BLANCA) --- */
        /* Estos estilos ya no se usar√°n si el modal intermedio se elimina del HTML */
        #intermediateModalContainer {
            z-index: 11; /* Asegura que est√© por encima del modal principal */
        }

        .intermediate-modal-content {
            background-color: #ffffff; /* Fondo blanco para la tarjeta */
            padding: 30px 40px; /* Ajuste de padding */
            border-radius: 15px; /* Bordes m√°s suaves para la tarjeta */
            box-shadow: 0 8px 25px rgba(0, 0, 0, 0.3); /* Sombra m√°s pronunciada */
            max-width: 500px; /* Un poco m√°s peque√±o que el modal principal */
            width: 85%;
            position: relative;
            overflow: hidden;
            transform: scale(0.9);
            transition: transform 0.5s cubic-bezier(0.175, 0.885, 0.32, 1.275);
            will-change: transform;
            cursor: pointer; /* Para indicar que es clickeable */
            display: flex; /* Para organizar el coraz√≥n y el texto */
            flex-direction: column; /* Contenido en columna */
            align-items: center; /* Centrar items */
            gap: 20px; /* Espacio entre elementos */
        }

        .intermediate-modal-content::before {
            display: none; /* Eliminamos el pseudo-elemento ::before para el degradado */
        }

        .intermediate-modal-content .white-heart-svg {
            width: 100px; /* Tama√±o del coraz√≥n SVG */
            height: 100px;
            fill: #FF69B4; /* Color rosa para el coraz√≥n en la carta */
            filter: drop-shadow(0 0 8px rgba(0,0,0,0.3)); /* Sombra suave para el coraz√≥n */
        }

        .intermediate-modal-content .to-maylin-text {
            font-family: 'Dancing Script', cursive;
            color: #333333; /* Color de texto oscuro */
            font-size: 3.5rem; /* Tama√±o de fuente grande */
            text-align: center;
            margin-top: -10px; /* Ajuste de margen para acercar al texto del coraz√≥n */
        }

        /* Ajustes responsivos para el modal intermedio */
        @media (max-width: 850px) {
            .intermediate-modal-content .to-maylin-text { font-size: 3rem; }
            .intermediate-modal-content .white-heart-svg { width: 80px; height: 80px; }
        }
        @media (max-width: 480px) {
            .intermediate-modal-content { padding: 25px 15px; width: 90%; }
            .intermediate-modal-content .to-maylin-text { font-size: 2.5rem; }
            .intermediate-modal-content .white-heart-svg { width: 60px; height: 60px; }
        }
    </style>
</head>
<body>

    <!-- Contenedor de la pantalla de carga inicial -->
    <div id="loader-container">
        <div class="loader-content">
            <div class="loader-heart"></div> <!-- Coraz√≥n animado de carga -->
            <div class="progress-bar-container">
                <div id="progress-bar"></div> <!-- Barra de progreso -->
            </div>
            <p id="progress-text">Cargando universo... <span id="progress-percent">0%</span></p>
        </div>
    </div>

    <!-- Canvas para el fondo 3D (estrellas y coraz√≥n amarillo) -->
    <canvas id="bg"></canvas>

    <!-- Elemento de audio para la m√∫sica de fondo (descomentar y a√±adir tu archivo .mp3) -->
    <!-- <audio id="backgroundMusic" loop>
         <source src="images/sound.mp3" type="audio/mpeg"> 
    </audio> -->

    <!-- Texto "Presiona aqu√≠, Sister" para invitar a abrir el modal -->
    <div class="click-me-container">
        <h2 id="clickMeText">¬°Presiona aqu√≠, Sister!</h2>
    </div>

    <!-- Contenedor de la ventana modal principal con el mensaje de cumplea√±os -->
    <div id="modalContainer" class="modal-container">
        <div class="modal-content">
            <span class="close-button">√ó</span> <!-- Bot√≥n para cerrar el modal -->
            <h1>¬°Feliz Cumplea√±os, Maylin!</h1> <!-- T√≠tulo personalizado -->
            <div class="modal-body">
                <div class="text-content">
                    <p>
                        Hoy es un d√≠a muy especial üí´<br>
                        porque el mundo celebra tu existencia üåç<br><br>
                        Gracias por ser una amiga incre√≠ble üåü<br>
                        por tu risa, tu apoyo y tu luz ‚ú®<br><br>
                        ¬°Te deseo un d√≠a lleno de amor ‚ù§Ô∏è<br>
                        alegr√≠a üéâ y sue√±os cumplidos! üéÅ
                    </p>
                    <p class="signature">Con mucho cari√±o,<br>tu sister preferido Dark üòä</p> <!-- Firma personalizada -->
                </div>
            </div>
        </div>
    </div>

    <!-- Importaci√≥n de Three.js para gr√°ficos 3D -->
    <script type="importmap">
        { "imports": { "three": "https://cdn.jsdelivr.net/npm/three@0.166.0/build/three.module.js" } }
    </script>
    
    <script type="module">
        import * as THREE from 'three';
        
        // Elementos de la pantalla de carga
        const loaderContainer = document.getElementById('loader-container');
        const progressBar = document.getElementById('progress-bar');
        const progressPercent = document.getElementById('progress-percent');
        const clickMeContainer = document.querySelector('.click-me-container');
        
        let progress = 0;
        // Simulaci√≥n de barra de progreso
        const interval = setInterval(() => {
            progress += Math.random() * 10;
            if (progress > 90) progress = 90;
            progressBar.style.width = progress + '%';
            progressPercent.textContent = Math.floor(progress) + '%';
        }, 300);

        // Cuando la ventana se carga completamente
        window.onload = () => {
            clearInterval(interval);
            progressBar.style.width = '100%';
            progressPercent.textContent = '100%';
            setTimeout(() => {
                loaderContainer.classList.add('hidden'); // Oculta la pantalla de carga
                clickMeContainer.style.opacity = '1'; // Muestra el texto "Presiona aqu√≠, Sister"
            }, 500);
            init3D(); // Inicializa la escena 3D
        };
        
        let renderer; // Variable global para el renderizador de Three.js
        let heart; // Variable global para el coraz√≥n 3D
        let highlightSprite; // Variable global para el sprite del reflejo

        // Funci√≥n para crear una textura de reflejo difuso para el coraz√≥n
        function createHighlightTexture() {
            const canvas = document.createElement('canvas');
            canvas.width = 128;
            canvas.height = 128;
            const context = canvas.getContext('2d');
            
            const gradient = context.createRadialGradient(
                canvas.width / 2, canvas.height / 2, 0,
                canvas.width / 2, canvas.height / 2, canvas.width / 2
            );
            gradient.addColorStop(0, 'rgba(255, 255, 255, 0.6)');
            gradient.addColorStop(0.4, 'rgba(255, 255, 255, 0.2)');
            gradient.addColorStop(1, 'rgba(255, 255, 255, 0)');
            
            context.fillStyle = gradient;
            context.fillRect(0, 0, canvas.width, canvas.height);
            
            return new THREE.CanvasTexture(canvas);
        }

        // Elementos de los modales
        // const intermediateModalContainer = document.getElementById('intermediateModalContainer'); // Eliminado
        // const intermediateModalContent = document.querySelector('.intermediate-modal-content'); // Eliminado
        const modalContainer = document.getElementById('modalContainer');
        const closeButton = document.querySelector('.close-button');

        // Funci√≥n para inicializar y animar la escena 3D
        function init3D() {
            const audio = document.getElementById('backgroundMusic');
            // Reproduce la m√∫sica al primer clic del usuario (para evitar bloqueo del navegador)
            document.body.addEventListener('click', () => {
                if (audio && audio.paused) audio.play().catch(e => console.log("Reproducci√≥n autom√°tica de audio bloqueada."));
            }, { once: true });
            
            const scene = new THREE.Scene(); // Escena 3D
            const camera = new THREE.PerspectiveCamera(75, window.innerWidth / window.innerHeight, 0.1, 1000); // C√°mara
            camera.position.z = 5; // Posici√≥n inicial de la c√°mara

            // Renderizador WebGL
            renderer = new THREE.WebGLRenderer({ canvas: document.querySelector('#bg'), alpha: true, antialias: true });
            renderer.setPixelRatio(window.devicePixelRatio);
            renderer.setSize(window.innerWidth, window.innerHeight);
            renderer.shadowMap.enabled = true; // Habilita sombras
            renderer.shadowMap.type = THREE.PCFSoftShadowMap; // Tipo de sombras suaves

            // Luces de la escena
            const ambientLight = new THREE.AmbientLight(0xffffff, 0.3); // Luz ambiental
            scene.add(ambientLight);
            const pointLight = new THREE.PointLight(0xffdddd, 2, 100); // Luz puntual
            pointLight.position.set(0, 0, 8);
            pointLight.castShadow = true;
            pointLight.shadow.mapSize.width = 1024;
            pointLight.shadow.mapSize.height = 1024;
            scene.add(pointLight);
            const directionalLight = new THREE.DirectionalLight(0xffffff, 0.5); // Luz direccional
            directionalLight.position.set(5, 5, 5);
            directionalLight.castShadow = true;
            scene.add(directionalLight);

            // Forma del coraz√≥n 3D
            const heartShape = new THREE.Shape();
            const x = -2.5, y = -5;
            heartShape.moveTo(x + 2.5, y + 2.5);
            heartShape.bezierCurveTo(x + 2.5, y + 2.5, x + 2, y, x, y);
            heartShape.bezierCurveTo(x - 3, y, x - 3, y + 3.5, x - 3, y + 3.5);
            heartShape.bezierCurveTo(x - 3, y + 5.5, x - 1.5, y + 7.7, x + 2.5, y + 9.5);
            heartShape.bezierCurveTo(x + 6, y + 7.7, x + 8, y + 5.5, x + 8, y + 3.5);
            heartShape.bezierCurveTo(x + 8, y + 3.5, x + 8, y, x + 5, y);
            heartShape.bezierCurveTo(x + 3.5, y, x + 2.5, y + 2.5, x + 2.5, y + 2.5);

            // Configuraci√≥n para la extrusi√≥n 3D del coraz√≥n
            const extrudeSettings = { steps: 8, depth: 2.5, bevelEnabled: true, bevelThickness: 0.8, bevelSize: 0.5, bevelOffset: -0.1, bevelSegments: 32 };
            const geometry = new THREE.ExtrudeGeometry(heartShape, extrudeSettings);
            // Material del coraz√≥n (AMARILLO con reflejos)
            const material = new THREE.MeshPhysicalMaterial({
                color: 0xFFFF00, metalness: 0.05, roughness: 0.15, // Color del coraz√≥n cambiado a AMARILLO
                clearcoat: 1, clearcoatRoughness: 0.5,
                transmission: 0.05, thickness: 0.8, emissive: 0xFFFF00, emissiveIntensity: 0.6, reflectivity: 0.9, // Emisivo AMARILLO
            });
            heart = new THREE.Mesh(geometry, material); // Asignar a la variable global 'heart'
            heart.scale.set(0.2, 0.2, 0.2); // Escala inicial del coraz√≥n
            heart.rotation.x = Math.PI; // Orientaci√≥n
            heart.castShadow = true;
            heart.receiveShadow = true;
            scene.add(heart); // A√±ade el coraz√≥n a la escena

            // Crear y a√±adir el sprite del reflejo para el coraz√≥n
            const highlightTexture = createHighlightTexture();
            const highlightMaterial = new THREE.SpriteMaterial({
                map: highlightTexture,
                blending: THREE.AdditiveBlending,
                transparent: true,
                opacity: 0.8,
                depthWrite: false
            });
            highlightSprite = new THREE.Sprite(highlightMaterial); // Asignar a la variable global 'highlightSprite'
            highlightSprite.position.set(0.2, 1, 1.5); // Posici√≥n del reflejo
            heart.add(highlightSprite); // A√±ade el reflejo como hijo del coraz√≥n

            // Creaci√≥n de las estrellas de fondo
            const starsGeometry = new THREE.BufferGeometry();
            const starsCount = 12000;
            const posArray = new Float32Array(starsCount * 3);
            const colors = new Float32Array(starsCount * 3);
            const sizes = new Float32Array(starsCount);

            for (let i = 0; i < starsCount; i++) {
                const angle = Math.random() * Math.PI * 2;
                const radius = Math.random() * 30 + 20;
                posArray[i * 3 + 0] = Math.cos(angle) * radius;
                posArray[i * 3 + 1] = Math.sin(angle) * radius;
                posArray[i * 3 + 2] = (Math.random() - 0.5) * 120 - 30; // Posici√≥n Z para el efecto de profundidad

                const brightness = Math.random() * 0.7 + 0.8;
                const starType = Math.random();
                // Asigna colores aleatorios a las estrellas
                if (starType < 0.4) { colors[i * 3 + 0] = 1 * brightness; colors[i * 3 + 1] = 1 * brightness; colors[i * 3 + 2] = 1 * brightness;
                } else if (starType < 0.65) { colors[i * 3 + 0] = 1 * brightness; colors[i * 3 + 1] = 0.7 * brightness; colors[i * 3 + 2] = 0.3 * brightness;
                } else if (starType < 0.85) { colors[i * 3 + 0] = 1 * brightness; colors[i * 3 + 1] = 0.4 * brightness; colors[i * 3 + 2] = 0.6 * brightness;
                } else { colors[i * 3 + 0] = 0.6 * brightness; colors[i * 3 + 1] = 0.8 * brightness; colors[i * 3 + 2] = 1 * brightness; }
                sizes[i] = Math.random() * 0.3 + 0.1;
            }
            starsGeometry.setAttribute('position', new THREE.BufferAttribute(posArray, 3));
            starsGeometry.setAttribute('color', new THREE.BufferAttribute(colors, 3));
            starsGeometry.setAttribute('size', new THREE.BufferAttribute(sizes, 1));

            const isMobile = window.innerWidth <= 768;
            const starsMaterial = new THREE.PointsMaterial({ size: isMobile ? 0.20 : 0.25, vertexColors: true, blending: THREE.AdditiveBlending, transparent: true, opacity: 1, sizeAttenuation: true });
            const starsMesh = new THREE.Points(starsGeometry, starsMaterial);
            scene.add(starsMesh); // A√±ade las estrellas a la escena

            // L√≥gica para abrir y cerrar los modales
            // Funci√≥n para abrir el modal principal directamente
            function openMainModal() {
                console.log("Abriendo modal principal..."); // Debugging
                if (!modalContainer.classList.contains('active')) {
                    modalContainer.classList.add('active');
                    if (renderer) renderer.setPixelRatio(window.devicePixelRatio * 0.5); // Asegura que el pixel ratio se ajuste
                }
            }
            // Funci√≥n para cerrar el modal principal
            function closeMainModal() {
                console.log("Cerrando modal principal..."); // Debugging
                modalContainer.classList.remove('active');
                if (renderer) renderer.setPixelRatio(window.devicePixelRatio);
            }

            // Event listeners para abrir/cerrar los modales
            clickMeText.addEventListener('click', () => {
                console.log("Clic en 'Presiona aqu√≠, Sister!'"); // Debugging
                openMainModal(); // Ahora abre directamente el modal principal
            });

            closeButton.addEventListener('click', () => {
                console.log("Clic en el bot√≥n de cerrar del modal principal."); // Debugging
                closeMainModal(); // El bot√≥n de cerrar siempre cierra el modal principal
            });
            modalContainer.addEventListener('click', (e) => { // Cierra el modal principal si se hace clic fuera del contenido
                if (e.target === modalContainer) {
                    console.log("Clic fuera del contenido del modal principal."); // Debugging
                    closeMainModal();
                }
            });

            // Raycaster para detectar clics en el coraz√≥n 3D (ahora abre el modal principal directamente)
            const raycaster = new THREE.Raycaster();
            const mouse = new THREE.Vector2();
            function onHeartClick(event) {
                mouse.x = (event.clientX / window.innerWidth) * 2 - 1;
                mouse.y = -(event.clientY / window.innerHeight) * 2 + 1;
                raycaster.setFromCamera(mouse, camera);
                const intersects = raycaster.intersectObject(heart);
                if (intersects.length > 0) {
                    console.log("Clic en el coraz√≥n 3D."); // Debugging
                    openMainModal(); // Ahora abre directamente el modal principal
                }
            }
            window.addEventListener('click', onHeartClick, false);

            // Bucle de animaci√≥n principal
            const clock = new THREE.Clock();
            function animate() {
                requestAnimationFrame(animate); // Solicita el siguiente frame de animaci√≥n
                const elapsedTime = clock.getElapsedTime(); // Tiempo transcurrido
                const beatFrequency = 2.8; // Frecuencia del pulso del coraz√≥n
                const beatStrength = 0.045; // Intensidad del pulso
                const pulse = Math.pow(Math.sin(elapsedTime * beatFrequency), 8) * beatStrength; // C√°lculo del pulso

                const baseScale = 0.2;
                heart.scale.set(baseScale + pulse, baseScale + pulse, baseScale + pulse); // Escala el coraz√≥n con el pulso
                
                // Animar la escala y opacidad del sprite del reflejo
                const baseHighlightScale = 1.8;
                const highlightPulseAmount = 1.2;
                const newHighlightScale = baseHighlightScale + (pulse / beatStrength) * highlightPulseAmount;
                // Asegurarse de que highlightSprite est√© definido antes de intentar acceder a sus propiedades
                if (highlightSprite) {
                    highlightSprite.scale.set(newHighlightScale, newHighlightScale, 1);
                    highlightSprite.material.opacity = 0.6 + (pulse / beatStrength) * 0.4;
                }

                // Mueve las estrellas para dar un efecto de profundidad
                const starPositions = starsMesh.geometry.attributes.position.array;
                for (let i = 0; i < starsCount; i++) {
                    starPositions[i * 3 + 2] += 0.2; // Mueve las estrellas hacia adelante
                    if (starPositions[i * 3 + 2] > 15) starPositions[i * 3 + 2] = -60 - Math.random() * 30; // Reinicia la posici√≥n si se van muy lejos
                }
                starsMesh.geometry.attributes.position.needsUpdate = true; // Actualiza la geometr√≠a de las estrellas
                starsMesh.rotation.z += 0.0005; // Rotaci√≥n lenta de las estrellas
                renderer.render(scene, camera); // Renderiza la escena
            }

            // Manejo del redimensionamiento de la ventana
            window.addEventListener('resize', () => {
                renderer.setSize(window.innerWidth, window.innerHeight);
                camera.aspect = window.innerWidth / window.innerHeight;
                camera.updateProjectionMatrix();
                // Ajusta el pixel ratio del renderizador si el modal no est√° activo
                if (!modalContainer.classList.contains('active')) { // Solo verificamos el modal principal
                    renderer.setPixelRatio(window.devicePixelRatio);
                }
            });

            animate(); // Inicia el bucle de animaci√≥n
        }
    </script>
</body>
</html>
